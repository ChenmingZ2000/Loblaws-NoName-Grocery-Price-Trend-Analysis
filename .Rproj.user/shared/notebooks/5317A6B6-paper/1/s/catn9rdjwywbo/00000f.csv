"0","#| label: fig-2"
"0","#| fig-cap: Average Support Rate  for Donald Trump from 2024-07-21 to 2024-10-23 reported by different pollsters"
"0","#| echo: false"
"0","# Group data by date and product type, and calculate average price for each type per date"
"0","type_trend_data <- analysis_data %>%"
"0","  group_by(date, type) %>%"
"0","  summarise(avg_price = mean(current_price, na.rm = TRUE)) %>%"
"0","  ungroup()"
"1","[38;5;232m`summarise()` has grouped output by 'date'. You can override using the `.groups` argument.[39m
"
"0","p3 <- ggplot(type_trend_data, aes(x = date, y = avg_price, color = type)) +"
"0","  geom_line(size = 0.7) +"
"0","  labs("
"0","    x = ""Date"","
"0","    y = ""Average Price"","
"0","    title = ""Price Trend by Time and Product Type"","
"0","    color = ""Product Type"""
"0","  ) +"
"0","  theme_minimal() +"
"0","  theme(axis.text.x = element_text(size = 5),"
"0","    axis.text.y = element_text(size = 5),"
"0","    plot.title = element_text(size = 7, face = ""bold"", color = ""#333333""),"
"0","    plot.subtitle = element_text(size = 6, color = ""#333333""),"
"0","    legend.title = element_text(size = 5, color = ""#333333""),"
"0","    legend.text = element_text(size = 5, color = ""#333333""),"
"0","    legend.key.size = unit(0.5, ""lines""),"
"0","    axis.title = element_text(size = 6, color = ""#333333""),"
"0","    strip.text = element_text(size = 5)"
"0",")"
"0",""
"0","# Group data by date and product size, and calculate average price for each size per date"
"0","size_trend_data <- analysis_data %>%"
"0","  group_by(date, size) %>%"
"0","  summarise(avg_price = mean(current_price, na.rm = TRUE)) %>%"
"0","  ungroup()"
"1","[38;5;232m`summarise()` has grouped output by 'date'. You can override using the `.groups` argument.[39m
"
"0","# Plot the trend"
"0","p4 <- ggplot(size_trend_data, aes(x = date, y = avg_price, color = size)) +"
"0","  geom_line(size = 0.7) +"
"0","  labs("
"0","    x = ""Date"","
"0","    y = ""Average Price"","
"0","    title = ""Price Trend by Time and Product Size"","
"0","    color = ""Product Size"""
"0","  ) +"
"0","  theme_minimal() +"
"0","  theme(axis.text.x = element_text(size = 5),"
"0","    axis.text.y = element_text(size = 5),"
"0","    plot.title = element_text(size = 7, face = ""bold"", color = ""#333333""),"
"0","    plot.subtitle = element_text(size = 6, color = ""#333333""),"
"0","    legend.title = element_text(size = 5, color = ""#333333""),"
"0","    legend.text = element_text(size = 5, color = ""#333333""),"
"0","    legend.key.size = unit(0.5, ""lines""),"
"0","    axis.title = element_text(size = 6, color = ""#333333""),"
"0","    strip.text = element_text(size = 5)"
"0",")"
"0",""
"0","p3 + p4"
